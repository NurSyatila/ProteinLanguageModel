CUDA available: False
Number of GPUs: 0
Namespace(objective='sv', default=True, optim=False, inp_path='data/fluorescence.csv', out_path='results/sv_esm2_t6_8M_UR50D_full_default', seqcol='sequence', ycol='label', truncate=1.0, checkpoint='facebook/esm2_t6_8M_UR50D', full=True, lora_r=4, lora_alpha=1, lora_weights='qkvo', lora_dropout=0.0, epochs=20, lr=1e-05, batch=8, accum=1, val_batch=8, seed=42, num_labels=1, earlystop=False, n_trials1=3, n_trials2=3)
PERFORM FULL MODEL FINETUNING...
device: cpu
{'train': Dataset({
    features: ['sequence', 'label', '__index_level_0__', 'input_ids', 'attention_mask'],
    num_rows: 2097
}), 'valid': Dataset({
    features: ['sequence', 'label', '__index_level_0__', 'input_ids', 'attention_mask'],
    num_rows: 524
}), 'test': Dataset({
    features: ['sequence', 'label', '__index_level_0__', 'input_ids', 'attention_mask'],
    num_rows: 2552
})}
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512122
{'loss': 8.2808, 'grad_norm': 34.03390121459961, 'learning_rate': 5.240000000000001e-06, 'epoch': 1.0}
{'eval_loss': 4.222642421722412, 'eval_spearmanr': 0.31501676424283415, 'eval_runtime': 8.4724, 'eval_samples_per_second': 61.848, 'eval_steps_per_second': 7.79, 'epoch': 1.0}
{'loss': 2.2571, 'grad_norm': 11.436820983886719, 'learning_rate': 9.999319393624579e-06, 'epoch': 2.0}
{'eval_loss': 0.9215928316116333, 'eval_spearmanr': 0.22673093221624543, 'eval_runtime': 8.0917, 'eval_samples_per_second': 64.758, 'eval_steps_per_second': 8.157, 'epoch': 2.0}
{'loss': 0.6734, 'grad_norm': 269.04913330078125, 'learning_rate': 9.909946036218694e-06, 'epoch': 3.0}
{'eval_loss': 0.7722669839859009, 'eval_spearmanr': 0.26746924509139786, 'eval_runtime': 7.6704, 'eval_samples_per_second': 68.315, 'eval_steps_per_second': 8.605, 'epoch': 3.0}
{'loss': 0.5777, 'grad_norm': 14.964556694030762, 'learning_rate': 9.673007684510775e-06, 'epoch': 4.0}
{'eval_loss': 0.5480073094367981, 'eval_spearmanr': 0.3258934045814179, 'eval_runtime': 8.025, 'eval_samples_per_second': 65.296, 'eval_steps_per_second': 8.224, 'epoch': 4.0}
{'loss': 0.5866, 'grad_norm': 30.1397647857666, 'learning_rate': 9.295625354956361e-06, 'epoch': 5.0}
{'eval_loss': 0.50773686170578, 'eval_spearmanr': 0.44888460494831467, 'eval_runtime': 8.0406, 'eval_samples_per_second': 65.169, 'eval_steps_per_second': 8.208, 'epoch': 5.0}
{'loss': 0.5088, 'grad_norm': 19.037996292114258, 'learning_rate': 8.78914100954436e-06, 'epoch': 6.0}
{'eval_loss': 0.40479135513305664, 'eval_spearmanr': 0.46725957818334407, 'eval_runtime': 8.1167, 'eval_samples_per_second': 64.558, 'eval_steps_per_second': 8.131, 'epoch': 6.0}
{'loss': 0.5013, 'grad_norm': 25.512720108032227, 'learning_rate': 8.168776681061583e-06, 'epoch': 7.0}
{'eval_loss': 0.4439571499824524, 'eval_spearmanr': 0.4263907322224503, 'eval_runtime': 8.0709, 'eval_samples_per_second': 64.924, 'eval_steps_per_second': 8.178, 'epoch': 7.0}
{'loss': 0.4559, 'grad_norm': 205.88243103027344, 'learning_rate': 7.453176985543002e-06, 'epoch': 8.0}
{'eval_loss': 0.38759276270866394, 'eval_spearmanr': 0.5377282106450751, 'eval_runtime': 7.9197, 'eval_samples_per_second': 66.164, 'eval_steps_per_second': 8.334, 'epoch': 8.0}
{'loss': 0.3643, 'grad_norm': 41.60798263549805, 'learning_rate': 6.663848771376116e-06, 'epoch': 9.0}
{'eval_loss': 0.32653769850730896, 'eval_spearmanr': 0.5357724120926887, 'eval_runtime': 5.5542, 'eval_samples_per_second': 94.343, 'eval_steps_per_second': 11.883, 'epoch': 9.0}
{'loss': 0.3558, 'grad_norm': 75.10427856445312, 'learning_rate': 5.824514746013667e-06, 'epoch': 10.0}
{'eval_loss': 0.29571470618247986, 'eval_spearmanr': 0.5408292808587806, 'eval_runtime': 5.3631, 'eval_samples_per_second': 97.705, 'eval_steps_per_second': 12.306, 'epoch': 10.0}
{'loss': 0.3134, 'grad_norm': 28.188844680786133, 'learning_rate': 4.960400506591848e-06, 'epoch': 11.0}
{'eval_loss': 0.23334598541259766, 'eval_spearmanr': 0.6008179040408362, 'eval_runtime': 5.2753, 'eval_samples_per_second': 99.33, 'eval_steps_per_second': 12.511, 'epoch': 11.0}
{'loss': 0.2903, 'grad_norm': 4.13432502746582, 'learning_rate': 4.0974764022501355e-06, 'epoch': 12.0}
{'eval_loss': 0.25306394696235657, 'eval_spearmanr': 0.5703976237870788, 'eval_runtime': 5.3688, 'eval_samples_per_second': 97.6, 'eval_steps_per_second': 12.293, 'epoch': 12.0}
{'loss': 0.2476, 'grad_norm': 106.3018798828125, 'learning_rate': 3.261677013450506e-06, 'epoch': 13.0}
{'eval_loss': 0.21093520522117615, 'eval_spearmanr': 0.6290677777103271, 'eval_runtime': 5.4808, 'eval_samples_per_second': 95.606, 'eval_steps_per_second': 12.042, 'epoch': 13.0}
{'loss': 0.2012, 'grad_norm': 564.5931396484375, 'learning_rate': 2.4781217062992417e-06, 'epoch': 14.0}
{'eval_loss': 0.19726721942424774, 'eval_spearmanr': 0.6375612615394614, 'eval_runtime': 5.3718, 'eval_samples_per_second': 97.547, 'eval_steps_per_second': 12.286, 'epoch': 14.0}
{'loss': 0.1855, 'grad_norm': 10.263618469238281, 'learning_rate': 1.7703596875660645e-06, 'epoch': 15.0}
{'eval_loss': 0.2195785790681839, 'eval_spearmanr': 0.6269341263659969, 'eval_runtime': 5.2729, 'eval_samples_per_second': 99.377, 'eval_steps_per_second': 12.517, 'epoch': 15.0}
{'loss': 0.1575, 'grad_norm': 12.591609954833984, 'learning_rate': 1.1596622497440357e-06, 'epoch': 16.0}
{'eval_loss': 0.17801479995250702, 'eval_spearmanr': 0.6490631035219474, 'eval_runtime': 5.3288, 'eval_samples_per_second': 98.334, 'eval_steps_per_second': 12.386, 'epoch': 16.0}
{'loss': 0.1473, 'grad_norm': 6.104249000549316, 'learning_rate': 6.643834772299551e-07, 'epoch': 17.0}
{'eval_loss': 0.18552760779857635, 'eval_spearmanr': 0.6507478367938268, 'eval_runtime': 5.2743, 'eval_samples_per_second': 99.35, 'eval_steps_per_second': 12.514, 'epoch': 17.0}
{'loss': 0.1347, 'grad_norm': 15.376117706298828, 'learning_rate': 2.9940862715390483e-07, 'epoch': 18.0}
{'eval_loss': 0.19055217504501343, 'eval_spearmanr': 0.6435965925634828, 'eval_runtime': 5.521, 'eval_samples_per_second': 94.91, 'eval_steps_per_second': 11.954, 'epoch': 18.0}
{'loss': 0.1313, 'grad_norm': 0.2628406584262848, 'learning_rate': 7.570676338635896e-08, 'epoch': 19.0}
{'eval_loss': 0.17301303148269653, 'eval_spearmanr': 0.6516906018394312, 'eval_runtime': 5.2277, 'eval_samples_per_second': 100.236, 'eval_steps_per_second': 12.625, 'epoch': 19.0}
{'loss': 0.1262, 'grad_norm': 7.222738265991211, 'learning_rate': 1.0889948676151562e-12, 'epoch': 20.0}
{'eval_loss': 0.17349296808242798, 'eval_spearmanr': 0.6505160134254666, 'eval_runtime': 5.2752, 'eval_samples_per_second': 99.333, 'eval_steps_per_second': 12.511, 'epoch': 20.0}
{'train_runtime': 993.1331, 'train_samples_per_second': 42.23, 'train_steps_per_second': 5.296, 'train_loss': 0.8248379856008087, 'epoch': 20.0}
test score: 0.6435799201505665
Time taken:  1018.2456932067871 sec.
