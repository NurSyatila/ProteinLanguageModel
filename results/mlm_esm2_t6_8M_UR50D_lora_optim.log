CUDA available: False
Number of GPUs: 0
Namespace(objective='mlm', default=False, optim=True, inp_path='data/fluorescence_homologs.fasta', out_path='results/mlm_esm2_t6_8M_UR50D_lora_optim', seqcol='sequence', ycol='label', truncate=1.0, checkpoint='facebook/esm2_t6_8M_UR50D', full=False, lora_r=4, lora_alpha=1, lora_weights='qkvo', lora_dropout=0.0, epochs=20, lr=1e-05, batch=8, accum=1, val_batch=8, seed=42, num_labels=1, earlystop=False, n_trials1=3, n_trials2=3)
PERFORM LORA FINETUNING...
device: cpu
Given input is a local file. Data splits will be created...
DatasetDict({
    train: Dataset({
        features: ['id', 'sequence', 'input_ids', 'attention_mask'],
        num_rows: 467
    })
    valid: Dataset({
        features: ['id', 'sequence', 'input_ids', 'attention_mask'],
        num_rows: 117
    })
    test: Dataset({
        features: ['id', 'sequence', 'input_ids', 'attention_mask'],
        num_rows: 147
    })
})
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  276194
{'loss': 7.535, 'grad_norm': 17.332677841186523, 'learning_rate': 1.1600000000000001e-06, 'epoch': 1.0}
{'eval_loss': 8.223557472229004, 'eval_accuracy': 0.13365973072215423, 'eval_runtime': 1.1166, 'eval_samples_per_second': 104.785, 'eval_steps_per_second': 13.434, 'epoch': 1.0}
{'loss': 7.4535, 'grad_norm': 8.837227821350098, 'learning_rate': 2.3400000000000005e-06, 'epoch': 2.0}
{'eval_loss': 8.085957527160645, 'eval_accuracy': 0.13519980856664274, 'eval_runtime': 1.0492, 'eval_samples_per_second': 111.509, 'eval_steps_per_second': 14.296, 'epoch': 2.0}
{'loss': 7.289, 'grad_norm': 3.161015033721924, 'learning_rate': 3.52e-06, 'epoch': 3.0}
{'eval_loss': 8.169498443603516, 'eval_accuracy': 0.13540929464496343, 'eval_runtime': 1.0532, 'eval_samples_per_second': 111.087, 'eval_steps_per_second': 14.242, 'epoch': 3.0}
{'loss': 7.2865, 'grad_norm': 10.569169044494629, 'learning_rate': 4.7e-06, 'epoch': 4.0}
{'eval_loss': 8.14832592010498, 'eval_accuracy': 0.1305470767785865, 'eval_runtime': 1.0641, 'eval_samples_per_second': 109.956, 'eval_steps_per_second': 14.097, 'epoch': 4.0}
{'loss': 7.1627, 'grad_norm': 3.4483983516693115, 'learning_rate': 5.8800000000000005e-06, 'epoch': 5.0}
{'eval_loss': 7.84826135635376, 'eval_accuracy': 0.12505989458552946, 'eval_runtime': 1.0431, 'eval_samples_per_second': 112.17, 'eval_steps_per_second': 14.381, 'epoch': 5.0}
{'loss': 7.0063, 'grad_norm': 1.404872179031372, 'learning_rate': 7.06e-06, 'epoch': 6.0}
{'eval_loss': 7.914702415466309, 'eval_accuracy': 0.14147051686483864, 'eval_runtime': 1.0647, 'eval_samples_per_second': 109.887, 'eval_steps_per_second': 14.088, 'epoch': 6.0}
{'loss': 6.9836, 'grad_norm': 1.3115990161895752, 'learning_rate': 8.24e-06, 'epoch': 7.0}
{'eval_loss': 7.693717002868652, 'eval_accuracy': 0.13297613248904042, 'eval_runtime': 1.0491, 'eval_samples_per_second': 111.524, 'eval_steps_per_second': 14.298, 'epoch': 7.0}
{'loss': 6.9165, 'grad_norm': 5.238889694213867, 'learning_rate': 9.42e-06, 'epoch': 8.0}
{'eval_loss': 7.514662742614746, 'eval_accuracy': 0.13275193798449614, 'eval_runtime': 1.0804, 'eval_samples_per_second': 108.291, 'eval_steps_per_second': 13.883, 'epoch': 8.0}
{'loss': 6.6922, 'grad_norm': 3.8141138553619385, 'learning_rate': 9.952052154376027e-06, 'epoch': 9.0}
{'eval_loss': 7.265377044677734, 'eval_accuracy': 0.14320388349514562, 'eval_runtime': 1.0603, 'eval_samples_per_second': 110.35, 'eval_steps_per_second': 14.147, 'epoch': 9.0}
{'loss': 6.3932, 'grad_norm': 9.049361228942871, 'learning_rate': 9.583251048640941e-06, 'epoch': 10.0}
{'eval_loss': 6.951920032501221, 'eval_accuracy': 0.13449740443605473, 'eval_runtime': 1.0573, 'eval_samples_per_second': 110.654, 'eval_steps_per_second': 14.186, 'epoch': 10.0}
{'loss': 6.0793, 'grad_norm': 1.120962142944336, 'learning_rate': 8.87601988055565e-06, 'epoch': 11.0}
{'eval_loss': 6.45037841796875, 'eval_accuracy': 0.13843529125030465, 'eval_runtime': 1.0506, 'eval_samples_per_second': 111.368, 'eval_steps_per_second': 14.278, 'epoch': 11.0}
{'loss': 5.8507, 'grad_norm': 4.159237861633301, 'learning_rate': 7.882581032392252e-06, 'epoch': 12.0}
{'eval_loss': 6.126388072967529, 'eval_accuracy': 0.1326676176890157, 'eval_runtime': 1.0504, 'eval_samples_per_second': 111.381, 'eval_steps_per_second': 14.28, 'epoch': 12.0}
{'loss': 5.5146, 'grad_norm': 6.845655918121338, 'learning_rate': 6.67629063667697e-06, 'epoch': 13.0}
{'eval_loss': 5.985915184020996, 'eval_accuracy': 0.12988929889298892, 'eval_runtime': 1.0609, 'eval_samples_per_second': 110.28, 'eval_steps_per_second': 14.139, 'epoch': 13.0}
{'loss': 5.4083, 'grad_norm': 8.702245712280273, 'learning_rate': 5.346221914470959e-06, 'epoch': 14.0}
{'eval_loss': 5.703431606292725, 'eval_accuracy': 0.13374844333748442, 'eval_runtime': 1.08, 'eval_samples_per_second': 108.331, 'eval_steps_per_second': 13.889, 'epoch': 14.0}
{'loss': 5.2334, 'grad_norm': 3.4750585556030273, 'learning_rate': 3.99058795421495e-06, 'epoch': 15.0}
{'eval_loss': 5.68225622177124, 'eval_accuracy': 0.1252663982950509, 'eval_runtime': 1.0498, 'eval_samples_per_second': 111.448, 'eval_steps_per_second': 14.288, 'epoch': 15.0}
{'loss': 5.2155, 'grad_norm': 4.743105888366699, 'learning_rate': 2.7094895971730326e-06, 'epoch': 16.0}
{'eval_loss': 5.476217746734619, 'eval_accuracy': 0.13184438040345822, 'eval_runtime': 1.0681, 'eval_samples_per_second': 109.535, 'eval_steps_per_second': 14.043, 'epoch': 16.0}
{'loss': 5.0527, 'grad_norm': 4.0405426025390625, 'learning_rate': 1.5975239300526924e-06, 'epoch': 17.0}
{'eval_loss': 5.325760364532471, 'eval_accuracy': 0.1305951795376291, 'eval_runtime': 1.0954, 'eval_samples_per_second': 106.807, 'eval_steps_per_second': 13.693, 'epoch': 17.0}
{'loss': 5.0311, 'grad_norm': 4.074336051940918, 'learning_rate': 7.367991782295392e-07, 'epoch': 18.0}
{'eval_loss': 5.421590328216553, 'eval_accuracy': 0.12185176301271287, 'eval_runtime': 1.0455, 'eval_samples_per_second': 111.908, 'eval_steps_per_second': 14.347, 'epoch': 18.0}
{'loss': 5.052, 'grad_norm': 2.2677810192108154, 'learning_rate': 1.908717841359048e-07, 'epoch': 19.0}
{'eval_loss': 5.38252067565918, 'eval_accuracy': 0.1336621454993835, 'eval_runtime': 1.0426, 'eval_samples_per_second': 112.216, 'eval_steps_per_second': 14.387, 'epoch': 19.0}
{'loss': 5.0631, 'grad_norm': 1.8209986686706543, 'learning_rate': 5.336065552641323e-11, 'epoch': 20.0}
{'eval_loss': 5.250477313995361, 'eval_accuracy': 0.13989637305699482, 'eval_runtime': 1.0701, 'eval_samples_per_second': 109.335, 'eval_steps_per_second': 14.017, 'epoch': 20.0}
{'train_runtime': 203.505, 'train_samples_per_second': 45.896, 'train_steps_per_second': 5.798, 'train_loss': 6.210956896765757, 'epoch': 20.0}
test perplexity: 153.9097609341924
default score: 0.15269631031220435
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  143074
{'loss': 7.5352, 'grad_norm': 17.353343963623047, 'learning_rate': 1.1600000000000001e-06, 'epoch': 1.0}
{'eval_loss': 8.224215507507324, 'eval_accuracy': 0.13365973072215423, 'eval_runtime': 0.9804, 'eval_samples_per_second': 119.34, 'eval_steps_per_second': 15.3, 'epoch': 1.0}
{'loss': 7.4549, 'grad_norm': 8.860164642333984, 'learning_rate': 2.3400000000000005e-06, 'epoch': 2.0}
{'eval_loss': 8.088774681091309, 'eval_accuracy': 0.13543910026322087, 'eval_runtime': 0.9545, 'eval_samples_per_second': 122.573, 'eval_steps_per_second': 15.714, 'epoch': 2.0}
{'loss': 7.2927, 'grad_norm': 3.1923563480377197, 'learning_rate': 3.52e-06, 'epoch': 3.0}
{'eval_loss': 8.175418853759766, 'eval_accuracy': 0.13517338995046002, 'eval_runtime': 0.9572, 'eval_samples_per_second': 122.227, 'eval_steps_per_second': 15.67, 'epoch': 3.0}
{'loss': 7.2928, 'grad_norm': 11.153441429138184, 'learning_rate': 4.7e-06, 'epoch': 4.0}
{'eval_loss': 8.158307075500488, 'eval_accuracy': 0.1303122798779056, 'eval_runtime': 0.9894, 'eval_samples_per_second': 118.257, 'eval_steps_per_second': 15.161, 'epoch': 4.0}
{'loss': 7.1708, 'grad_norm': 3.783858299255371, 'learning_rate': 5.8800000000000005e-06, 'epoch': 5.0}
{'eval_loss': 7.859713554382324, 'eval_accuracy': 0.12505989458552946, 'eval_runtime': 1.0179, 'eval_samples_per_second': 114.937, 'eval_steps_per_second': 14.736, 'epoch': 5.0}
{'loss': 7.0159, 'grad_norm': 1.415323257446289, 'learning_rate': 7.06e-06, 'epoch': 6.0}
{'eval_loss': 7.927723407745361, 'eval_accuracy': 0.14147051686483864, 'eval_runtime': 1.004, 'eval_samples_per_second': 116.537, 'eval_steps_per_second': 14.941, 'epoch': 6.0}
{'loss': 6.9953, 'grad_norm': 1.3460382223129272, 'learning_rate': 8.24e-06, 'epoch': 7.0}
{'eval_loss': 7.710619926452637, 'eval_accuracy': 0.13273258645884073, 'eval_runtime': 0.953, 'eval_samples_per_second': 122.776, 'eval_steps_per_second': 15.741, 'epoch': 7.0}
{'loss': 6.935, 'grad_norm': 5.135533809661865, 'learning_rate': 9.42e-06, 'epoch': 8.0}
{'eval_loss': 7.545286178588867, 'eval_accuracy': 0.13323643410852712, 'eval_runtime': 0.9545, 'eval_samples_per_second': 122.574, 'eval_steps_per_second': 15.715, 'epoch': 8.0}
{'loss': 6.7289, 'grad_norm': 3.755131244659424, 'learning_rate': 9.952052154376027e-06, 'epoch': 9.0}
{'eval_loss': 7.334994316101074, 'eval_accuracy': 0.1429611650485437, 'eval_runtime': 0.9585, 'eval_samples_per_second': 122.072, 'eval_steps_per_second': 15.65, 'epoch': 9.0}
{'loss': 6.4786, 'grad_norm': 8.579784393310547, 'learning_rate': 9.583251048640941e-06, 'epoch': 10.0}
{'eval_loss': 7.094815731048584, 'eval_accuracy': 0.13496932515337423, 'eval_runtime': 0.9609, 'eval_samples_per_second': 121.767, 'eval_steps_per_second': 15.611, 'epoch': 10.0}
{'loss': 6.2337, 'grad_norm': 1.1330629587173462, 'learning_rate': 8.87601988055565e-06, 'epoch': 11.0}
{'eval_loss': 6.695932865142822, 'eval_accuracy': 0.13794784304167682, 'eval_runtime': 0.9987, 'eval_samples_per_second': 117.155, 'eval_steps_per_second': 15.02, 'epoch': 11.0}
{'loss': 6.077, 'grad_norm': 3.654568910598755, 'learning_rate': 7.882581032392252e-06, 'epoch': 12.0}
{'eval_loss': 6.423369407653809, 'eval_accuracy': 0.1336186400380409, 'eval_runtime': 1.0275, 'eval_samples_per_second': 113.866, 'eval_steps_per_second': 14.598, 'epoch': 12.0}
{'loss': 5.7618, 'grad_norm': 7.752984046936035, 'learning_rate': 6.67629063667697e-06, 'epoch': 13.0}
{'eval_loss': 6.306689739227295, 'eval_accuracy': 0.12841328413284134, 'eval_runtime': 0.9777, 'eval_samples_per_second': 119.663, 'eval_steps_per_second': 15.341, 'epoch': 13.0}
{'loss': 5.6669, 'grad_norm': 8.885716438293457, 'learning_rate': 5.346221914470959e-06, 'epoch': 14.0}
{'eval_loss': 6.01027250289917, 'eval_accuracy': 0.13449564134495642, 'eval_runtime': 0.96, 'eval_samples_per_second': 121.876, 'eval_steps_per_second': 15.625, 'epoch': 14.0}
{'loss': 5.4788, 'grad_norm': 3.625317096710205, 'learning_rate': 3.99058795421495e-06, 'epoch': 15.0}
{'eval_loss': 5.986727237701416, 'eval_accuracy': 0.12573999526403032, 'eval_runtime': 0.9635, 'eval_samples_per_second': 121.438, 'eval_steps_per_second': 15.569, 'epoch': 15.0}
{'loss': 5.4564, 'grad_norm': 5.096735000610352, 'learning_rate': 2.7094895971730326e-06, 'epoch': 16.0}
{'eval_loss': 5.759909152984619, 'eval_accuracy': 0.13304514889529298, 'eval_runtime': 0.9973, 'eval_samples_per_second': 117.316, 'eval_steps_per_second': 15.041, 'epoch': 16.0}
{'loss': 5.2815, 'grad_norm': 4.062880039215088, 'learning_rate': 1.5975239300526924e-06, 'epoch': 17.0}
{'eval_loss': 5.5986480712890625, 'eval_accuracy': 0.13600590260698475, 'eval_runtime': 0.9561, 'eval_samples_per_second': 122.37, 'eval_steps_per_second': 15.689, 'epoch': 17.0}
{'loss': 5.2575, 'grad_norm': 3.772885322570801, 'learning_rate': 7.367991782295392e-07, 'epoch': 18.0}
{'eval_loss': 5.697450160980225, 'eval_accuracy': 0.12449028544015352, 'eval_runtime': 0.975, 'eval_samples_per_second': 120.006, 'eval_steps_per_second': 15.385, 'epoch': 18.0}
{'loss': 5.2778, 'grad_norm': 1.9039920568466187, 'learning_rate': 1.908717841359048e-07, 'epoch': 19.0}
{'eval_loss': 5.655390739440918, 'eval_accuracy': 0.13514180024660913, 'eval_runtime': 0.9767, 'eval_samples_per_second': 119.789, 'eval_steps_per_second': 15.358, 'epoch': 19.0}
{'loss': 5.2885, 'grad_norm': 1.8705902099609375, 'learning_rate': 5.336065552641323e-11, 'epoch': 20.0}
{'eval_loss': 5.511756420135498, 'eval_accuracy': 0.1394029114236368, 'eval_runtime': 0.9551, 'eval_samples_per_second': 122.496, 'eval_steps_per_second': 15.705, 'epoch': 20.0}
{'train_runtime': 178.3428, 'train_samples_per_second': 52.371, 'train_steps_per_second': 6.616, 'train_loss': 6.333994823391155, 'epoch': 20.0}
test perplexity: 190.9022346370697
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  143074
{'loss': 7.5263, 'grad_norm': 71.82244873046875, 'learning_rate': 1.1600000000000001e-06, 'epoch': 1.0}
{'eval_loss': 8.19334602355957, 'eval_accuracy': 0.13414932680538555, 'eval_runtime': 1.0064, 'eval_samples_per_second': 116.261, 'eval_steps_per_second': 14.905, 'epoch': 1.0}
{'loss': 7.3986, 'grad_norm': 40.26047134399414, 'learning_rate': 2.3400000000000005e-06, 'epoch': 2.0}
{'eval_loss': 7.981204509735107, 'eval_accuracy': 0.13519980856664274, 'eval_runtime': 1.0022, 'eval_samples_per_second': 116.744, 'eval_steps_per_second': 14.967, 'epoch': 2.0}
{'loss': 7.1768, 'grad_norm': 12.376084327697754, 'learning_rate': 3.52e-06, 'epoch': 3.0}
{'eval_loss': 8.01949405670166, 'eval_accuracy': 0.13588110403397027, 'eval_runtime': 0.9946, 'eval_samples_per_second': 117.638, 'eval_steps_per_second': 15.082, 'epoch': 3.0}
{'loss': 7.1559, 'grad_norm': 11.871038436889648, 'learning_rate': 4.7e-06, 'epoch': 4.0}
{'eval_loss': 7.985296249389648, 'eval_accuracy': 0.12937309227518196, 'eval_runtime': 0.9583, 'eval_samples_per_second': 122.088, 'eval_steps_per_second': 15.652, 'epoch': 4.0}
{'loss': 7.0235, 'grad_norm': 8.673675537109375, 'learning_rate': 5.8800000000000005e-06, 'epoch': 5.0}
{'eval_loss': 7.67299222946167, 'eval_accuracy': 0.12769525634882606, 'eval_runtime': 0.9597, 'eval_samples_per_second': 121.914, 'eval_steps_per_second': 15.63, 'epoch': 5.0}
{'loss': 6.8256, 'grad_norm': 8.15009593963623, 'learning_rate': 7.06e-06, 'epoch': 6.0}
{'eval_loss': 7.615264415740967, 'eval_accuracy': 0.14511041009463724, 'eval_runtime': 1.0351, 'eval_samples_per_second': 113.034, 'eval_steps_per_second': 14.492, 'epoch': 6.0}
{'loss': 6.5757, 'grad_norm': 7.517269611358643, 'learning_rate': 8.24e-06, 'epoch': 7.0}
{'eval_loss': 6.95371150970459, 'eval_accuracy': 0.13054067218704335, 'eval_runtime': 0.98, 'eval_samples_per_second': 119.389, 'eval_steps_per_second': 15.306, 'epoch': 7.0}
{'loss': 6.0629, 'grad_norm': 74.64120483398438, 'learning_rate': 9.42e-06, 'epoch': 8.0}
{'eval_loss': 6.216443061828613, 'eval_accuracy': 0.13420542635658914, 'eval_runtime': 0.9677, 'eval_samples_per_second': 120.91, 'eval_steps_per_second': 15.501, 'epoch': 8.0}
{'loss': 5.5203, 'grad_norm': 55.9347038269043, 'learning_rate': 9.952052154376027e-06, 'epoch': 9.0}
{'eval_loss': 5.6501312255859375, 'eval_accuracy': 0.13058252427184466, 'eval_runtime': 0.9692, 'eval_samples_per_second': 120.719, 'eval_steps_per_second': 15.477, 'epoch': 9.0}
{'loss': 5.0633, 'grad_norm': 58.614280700683594, 'learning_rate': 9.583251048640941e-06, 'epoch': 10.0}
{'eval_loss': 5.338545322418213, 'eval_accuracy': 0.11939594148183105, 'eval_runtime': 0.963, 'eval_samples_per_second': 121.501, 'eval_steps_per_second': 15.577, 'epoch': 10.0}
{'loss': 4.7514, 'grad_norm': 39.933528900146484, 'learning_rate': 8.87601988055565e-06, 'epoch': 11.0}
{'eval_loss': 4.88925313949585, 'eval_accuracy': 0.12722398245186448, 'eval_runtime': 0.9629, 'eval_samples_per_second': 121.512, 'eval_steps_per_second': 15.579, 'epoch': 11.0}
{'loss': 4.5454, 'grad_norm': 54.63788986206055, 'learning_rate': 7.882581032392252e-06, 'epoch': 12.0}
{'eval_loss': 4.665811538696289, 'eval_accuracy': 0.11626248216833096, 'eval_runtime': 0.9614, 'eval_samples_per_second': 121.699, 'eval_steps_per_second': 15.602, 'epoch': 12.0}
{'loss': 4.3031, 'grad_norm': 51.159820556640625, 'learning_rate': 6.67629063667697e-06, 'epoch': 13.0}
{'eval_loss': 4.53184700012207, 'eval_accuracy': 0.11193111931119311, 'eval_runtime': 0.9611, 'eval_samples_per_second': 121.731, 'eval_steps_per_second': 15.607, 'epoch': 13.0}
{'loss': 4.2012, 'grad_norm': 84.60018920898438, 'learning_rate': 5.346221914470959e-06, 'epoch': 14.0}
{'eval_loss': 4.329775333404541, 'eval_accuracy': 0.1190535491905355, 'eval_runtime': 0.9622, 'eval_samples_per_second': 121.592, 'eval_steps_per_second': 15.589, 'epoch': 14.0}
{'loss': 4.0788, 'grad_norm': 50.87876892089844, 'learning_rate': 3.99058795421495e-06, 'epoch': 15.0}
{'eval_loss': 4.308460235595703, 'eval_accuracy': 0.11461046649301444, 'eval_runtime': 0.9643, 'eval_samples_per_second': 121.326, 'eval_steps_per_second': 15.555, 'epoch': 15.0}
{'loss': 4.0408, 'grad_norm': 88.29872131347656, 'learning_rate': 2.7094895971730326e-06, 'epoch': 16.0}
{'eval_loss': 4.177680969238281, 'eval_accuracy': 0.11983669548511047, 'eval_runtime': 0.9632, 'eval_samples_per_second': 121.469, 'eval_steps_per_second': 15.573, 'epoch': 16.0}
{'loss': 3.9393, 'grad_norm': 69.92680358886719, 'learning_rate': 1.5975239300526924e-06, 'epoch': 17.0}
{'eval_loss': 4.090579032897949, 'eval_accuracy': 0.11682242990654206, 'eval_runtime': 0.961, 'eval_samples_per_second': 121.745, 'eval_steps_per_second': 15.608, 'epoch': 17.0}
{'loss': 3.9177, 'grad_norm': 94.72339630126953, 'learning_rate': 7.367991782295392e-07, 'epoch': 18.0}
{'eval_loss': 4.1274824142456055, 'eval_accuracy': 0.11489565843127848, 'eval_runtime': 0.9621, 'eval_samples_per_second': 121.606, 'eval_steps_per_second': 15.591, 'epoch': 18.0}
{'loss': 3.9188, 'grad_norm': 73.57392883300781, 'learning_rate': 1.908717841359048e-07, 'epoch': 19.0}
{'eval_loss': 4.107217311859131, 'eval_accuracy': 0.11615289765721332, 'eval_runtime': 0.9634, 'eval_samples_per_second': 121.443, 'eval_steps_per_second': 15.57, 'epoch': 19.0}
{'loss': 3.9357, 'grad_norm': 58.728004455566406, 'learning_rate': 5.336065552641323e-11, 'epoch': 20.0}
{'eval_loss': 4.040555477142334, 'eval_accuracy': 0.12755983222304465, 'eval_runtime': 0.9619, 'eval_samples_per_second': 121.633, 'eval_steps_per_second': 15.594, 'epoch': 20.0}
{'train_runtime': 179.9599, 'train_samples_per_second': 51.9, 'train_steps_per_second': 6.557, 'train_loss': 5.398056379415221, 'epoch': 20.0}
test perplexity: 49.654375690550225
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  162914
{'loss': 7.5351, 'grad_norm': 17.345552444458008, 'learning_rate': 1.1600000000000001e-06, 'epoch': 1.0}
{'eval_loss': 8.223934173583984, 'eval_accuracy': 0.13365973072215423, 'eval_runtime': 1.0531, 'eval_samples_per_second': 111.1, 'eval_steps_per_second': 14.244, 'epoch': 1.0}
{'loss': 7.4542, 'grad_norm': 8.858009338378906, 'learning_rate': 2.3400000000000005e-06, 'epoch': 2.0}
{'eval_loss': 8.087409973144531, 'eval_accuracy': 0.13519980856664274, 'eval_runtime': 1.0307, 'eval_samples_per_second': 113.518, 'eval_steps_per_second': 14.554, 'epoch': 2.0}
{'loss': 7.2907, 'grad_norm': 3.1668875217437744, 'learning_rate': 3.52e-06, 'epoch': 3.0}
{'eval_loss': 8.172209739685059, 'eval_accuracy': 0.13517338995046002, 'eval_runtime': 1.0214, 'eval_samples_per_second': 114.552, 'eval_steps_per_second': 14.686, 'epoch': 3.0}
{'loss': 7.2891, 'grad_norm': 10.823282241821289, 'learning_rate': 4.7e-06, 'epoch': 4.0}
{'eval_loss': 8.152207374572754, 'eval_accuracy': 0.1305470767785865, 'eval_runtime': 1.0193, 'eval_samples_per_second': 114.789, 'eval_steps_per_second': 14.717, 'epoch': 4.0}
{'loss': 7.1657, 'grad_norm': 3.5603203773498535, 'learning_rate': 5.8800000000000005e-06, 'epoch': 5.0}
{'eval_loss': 7.85228967666626, 'eval_accuracy': 0.12505989458552946, 'eval_runtime': 1.0202, 'eval_samples_per_second': 114.679, 'eval_steps_per_second': 14.702, 'epoch': 5.0}
{'loss': 7.0095, 'grad_norm': 1.4102038145065308, 'learning_rate': 7.06e-06, 'epoch': 6.0}
{'eval_loss': 7.918874263763428, 'eval_accuracy': 0.14171317641349188, 'eval_runtime': 1.0207, 'eval_samples_per_second': 114.631, 'eval_steps_per_second': 14.696, 'epoch': 6.0}
{'loss': 6.9874, 'grad_norm': 1.3103197813034058, 'learning_rate': 8.24e-06, 'epoch': 7.0}
{'eval_loss': 7.698909282684326, 'eval_accuracy': 0.13321967851924013, 'eval_runtime': 1.0214, 'eval_samples_per_second': 114.547, 'eval_steps_per_second': 14.685, 'epoch': 7.0}
{'loss': 6.9224, 'grad_norm': 5.209227085113525, 'learning_rate': 9.42e-06, 'epoch': 8.0}
{'eval_loss': 7.524219512939453, 'eval_accuracy': 0.13202519379844962, 'eval_runtime': 1.0193, 'eval_samples_per_second': 114.788, 'eval_steps_per_second': 14.716, 'epoch': 8.0}
{'loss': 6.7036, 'grad_norm': 3.7960140705108643, 'learning_rate': 9.952052154376027e-06, 'epoch': 9.0}
{'eval_loss': 7.287069797515869, 'eval_accuracy': 0.14320388349514562, 'eval_runtime': 1.0663, 'eval_samples_per_second': 109.725, 'eval_steps_per_second': 14.067, 'epoch': 9.0}
{'loss': 6.4197, 'grad_norm': 8.99968433380127, 'learning_rate': 9.583251048640941e-06, 'epoch': 10.0}
{'eval_loss': 6.996102809906006, 'eval_accuracy': 0.13402548371873524, 'eval_runtime': 1.0183, 'eval_samples_per_second': 114.892, 'eval_steps_per_second': 14.73, 'epoch': 10.0}
{'loss': 6.1267, 'grad_norm': 1.1234450340270996, 'learning_rate': 8.87601988055565e-06, 'epoch': 11.0}
{'eval_loss': 6.521998882293701, 'eval_accuracy': 0.13672922252010725, 'eval_runtime': 1.0217, 'eval_samples_per_second': 114.518, 'eval_steps_per_second': 14.682, 'epoch': 11.0}
{'loss': 5.9144, 'grad_norm': 3.8805458545684814, 'learning_rate': 7.882581032392252e-06, 'epoch': 12.0}
{'eval_loss': 6.207056999206543, 'eval_accuracy': 0.1326676176890157, 'eval_runtime': 1.0197, 'eval_samples_per_second': 114.743, 'eval_steps_per_second': 14.711, 'epoch': 12.0}
{'loss': 5.5798, 'grad_norm': 7.094893932342529, 'learning_rate': 6.67629063667697e-06, 'epoch': 13.0}
{'eval_loss': 6.068666934967041, 'eval_accuracy': 0.12939729397293973, 'eval_runtime': 1.0318, 'eval_samples_per_second': 113.393, 'eval_steps_per_second': 14.538, 'epoch': 13.0}
{'loss': 5.4738, 'grad_norm': 8.823110580444336, 'learning_rate': 5.346221914470959e-06, 'epoch': 14.0}
{'eval_loss': 5.780814170837402, 'eval_accuracy': 0.13449564134495642, 'eval_runtime': 1.0207, 'eval_samples_per_second': 114.624, 'eval_steps_per_second': 14.695, 'epoch': 14.0}
{'loss': 5.2947, 'grad_norm': 3.5070431232452393, 'learning_rate': 3.99058795421495e-06, 'epoch': 15.0}
{'eval_loss': 5.7582268714904785, 'eval_accuracy': 0.12479280132607151, 'eval_runtime': 1.0548, 'eval_samples_per_second': 110.921, 'eval_steps_per_second': 14.221, 'epoch': 15.0}
{'loss': 5.2754, 'grad_norm': 4.83767032623291, 'learning_rate': 2.7094895971730326e-06, 'epoch': 16.0}
{'eval_loss': 5.5464701652526855, 'eval_accuracy': 0.13304514889529298, 'eval_runtime': 1.0307, 'eval_samples_per_second': 113.512, 'eval_steps_per_second': 14.553, 'epoch': 16.0}
{'loss': 5.1101, 'grad_norm': 4.061786651611328, 'learning_rate': 1.5975239300526924e-06, 'epoch': 17.0}
{'eval_loss': 5.39447021484375, 'eval_accuracy': 0.13182488932611905, 'eval_runtime': 1.0361, 'eval_samples_per_second': 112.918, 'eval_steps_per_second': 14.477, 'epoch': 17.0}
{'loss': 5.0886, 'grad_norm': 4.098934650421143, 'learning_rate': 7.367991782295392e-07, 'epoch': 18.0}
{'eval_loss': 5.491225719451904, 'eval_accuracy': 0.12377068841448789, 'eval_runtime': 1.0638, 'eval_samples_per_second': 109.985, 'eval_steps_per_second': 14.101, 'epoch': 18.0}
{'loss': 5.1094, 'grad_norm': 2.0430219173431396, 'learning_rate': 1.908717841359048e-07, 'epoch': 19.0}
{'eval_loss': 5.450768947601318, 'eval_accuracy': 0.1346485819975339, 'eval_runtime': 1.0497, 'eval_samples_per_second': 111.458, 'eval_steps_per_second': 14.29, 'epoch': 19.0}
{'loss': 5.1207, 'grad_norm': 1.9339869022369385, 'learning_rate': 5.336065552641323e-11, 'epoch': 20.0}
{'eval_loss': 5.31757116317749, 'eval_accuracy': 0.1381692573402418, 'eval_runtime': 1.0297, 'eval_samples_per_second': 113.621, 'eval_steps_per_second': 14.567, 'epoch': 20.0}
{'train_runtime': 195.0057, 'train_samples_per_second': 47.896, 'train_steps_per_second': 6.051, 'train_loss': 6.2435651100288005, 'epoch': 20.0}
test perplexity: 162.82937372844071
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  162914
{'loss': 7.5368, 'grad_norm': 17.41722297668457, 'learning_rate': 8.652838211442799e-07, 'epoch': 1.0}
{'eval_loss': 8.230084419250488, 'eval_accuracy': 0.13365973072215423, 'eval_runtime': 1.0442, 'eval_samples_per_second': 112.048, 'eval_steps_per_second': 14.365, 'epoch': 1.0}
{'loss': 7.466, 'grad_norm': 9.044903755187988, 'learning_rate': 1.745486328860013e-06, 'epoch': 2.0}
{'eval_loss': 8.110756874084473, 'eval_accuracy': 0.13472122517348648, 'eval_runtime': 1.0201, 'eval_samples_per_second': 114.692, 'eval_steps_per_second': 14.704, 'epoch': 2.0}
{'loss': 7.3196, 'grad_norm': 3.1453232765197754, 'learning_rate': 2.6256888365757455e-06, 'epoch': 3.0}
{'eval_loss': 8.216872215270996, 'eval_accuracy': 0.13446567586694974, 'eval_runtime': 1.0272, 'eval_samples_per_second': 113.898, 'eval_steps_per_second': 14.602, 'epoch': 3.0}
{'loss': 7.335, 'grad_norm': 13.583353042602539, 'learning_rate': 3.5058913442914786e-06, 'epoch': 4.0}
{'eval_loss': 8.22022819519043, 'eval_accuracy': 0.1300774829772247, 'eval_runtime': 1.0185, 'eval_samples_per_second': 114.878, 'eval_steps_per_second': 14.728, 'epoch': 4.0}
{'loss': 7.2238, 'grad_norm': 5.212891101837158, 'learning_rate': 4.386093852007211e-06, 'epoch': 5.0}
{'eval_loss': 7.931352615356445, 'eval_accuracy': 0.12434115955917585, 'eval_runtime': 1.0143, 'eval_samples_per_second': 115.35, 'eval_steps_per_second': 14.789, 'epoch': 5.0}
{'loss': 7.0796, 'grad_norm': 1.4616990089416504, 'learning_rate': 5.266296359722944e-06, 'epoch': 6.0}
{'eval_loss': 8.014517784118652, 'eval_accuracy': 0.13904392137830623, 'eval_runtime': 1.0769, 'eval_samples_per_second': 108.641, 'eval_steps_per_second': 13.928, 'epoch': 6.0}
{'loss': 7.0756, 'grad_norm': 1.2942698001861572, 'learning_rate': 6.146498867438677e-06, 'epoch': 7.0}
{'eval_loss': 7.817625522613525, 'eval_accuracy': 0.13127131027764247, 'eval_runtime': 1.0253, 'eval_samples_per_second': 114.113, 'eval_steps_per_second': 14.63, 'epoch': 7.0}
{'loss': 7.0412, 'grad_norm': 4.200987339019775, 'learning_rate': 7.02670137515441e-06, 'epoch': 8.0}
{'eval_loss': 7.696788311004639, 'eval_accuracy': 0.13202519379844962, 'eval_runtime': 1.0174, 'eval_samples_per_second': 114.999, 'eval_steps_per_second': 14.743, 'epoch': 8.0}
{'loss': 6.8778, 'grad_norm': 3.27260684967041, 'learning_rate': 7.423577341694526e-06, 'epoch': 9.0}
{'eval_loss': 7.5627312660217285, 'eval_accuracy': 0.141747572815534, 'eval_runtime': 1.0161, 'eval_samples_per_second': 115.151, 'eval_steps_per_second': 14.763, 'epoch': 9.0}
{'loss': 6.7067, 'grad_norm': 6.2233428955078125, 'learning_rate': 7.148475936511171e-06, 'epoch': 10.0}
{'eval_loss': 7.416615009307861, 'eval_accuracy': 0.13331760264275602, 'eval_runtime': 1.0334, 'eval_samples_per_second': 113.216, 'eval_steps_per_second': 14.515, 'epoch': 10.0}
{'loss': 6.5373, 'grad_norm': 1.1130480766296387, 'learning_rate': 6.620927929999815e-06, 'epoch': 11.0}
{'eval_loss': 7.135180950164795, 'eval_accuracy': 0.13819156714599073, 'eval_runtime': 1.0334, 'eval_samples_per_second': 113.22, 'eval_steps_per_second': 14.515, 'epoch': 11.0}
{'loss': 6.4801, 'grad_norm': 1.8805723190307617, 'learning_rate': 5.8798877898170606e-06, 'epoch': 12.0}
{'eval_loss': 6.959263801574707, 'eval_accuracy': 0.13195435092724678, 'eval_runtime': 1.0263, 'eval_samples_per_second': 114.003, 'eval_steps_per_second': 14.616, 'epoch': 12.0}
{'loss': 6.2263, 'grad_norm': 7.963636875152588, 'learning_rate': 4.980074373425538e-06, 'epoch': 13.0}
{'eval_loss': 6.924887180328369, 'eval_accuracy': 0.12890528905289053, 'eval_runtime': 1.0233, 'eval_samples_per_second': 114.338, 'eval_steps_per_second': 14.659, 'epoch': 13.0}
{'loss': 6.1891, 'grad_norm': 9.503965377807617, 'learning_rate': 3.987930454171309e-06, 'epoch': 14.0}
{'eval_loss': 6.646452903747559, 'eval_accuracy': 0.13499377334993773, 'eval_runtime': 1.0184, 'eval_samples_per_second': 114.881, 'eval_steps_per_second': 14.728, 'epoch': 14.0}
{'loss': 6.0063, 'grad_norm': 4.484561920166016, 'learning_rate': 2.9767165462374537e-06, 'epoch': 15.0}
{'eval_loss': 6.655584335327148, 'eval_accuracy': 0.1276343831399479, 'eval_runtime': 1.0156, 'eval_samples_per_second': 115.199, 'eval_steps_per_second': 14.769, 'epoch': 15.0}
{'loss': 5.9976, 'grad_norm': 6.3911824226379395, 'learning_rate': 2.0211013034418596e-06, 'epoch': 16.0}
{'eval_loss': 6.41801118850708, 'eval_accuracy': 0.13472622478386168, 'eval_runtime': 1.026, 'eval_samples_per_second': 114.037, 'eval_steps_per_second': 14.62, 'epoch': 16.0}
{'loss': 5.8123, 'grad_norm': 4.0899658203125, 'learning_rate': 1.1916479401426041e-06, 'epoch': 17.0}
{'eval_loss': 6.247154235839844, 'eval_accuracy': 0.13871126414166257, 'eval_runtime': 1.0168, 'eval_samples_per_second': 115.071, 'eval_steps_per_second': 14.753, 'epoch': 17.0}
{'loss': 5.7948, 'grad_norm': 4.96075439453125, 'learning_rate': 5.496038003055353e-07, 'epoch': 18.0}
{'eval_loss': 6.358887672424316, 'eval_accuracy': 0.12592947949148478, 'eval_runtime': 1.0128, 'eval_samples_per_second': 115.522, 'eval_steps_per_second': 14.81, 'epoch': 18.0}
{'loss': 5.8136, 'grad_norm': 1.5758388042449951, 'learning_rate': 1.4237781614288088e-07, 'epoch': 19.0}
{'eval_loss': 6.312647819519043, 'eval_accuracy': 0.1344019728729963, 'eval_runtime': 1.0128, 'eval_samples_per_second': 115.521, 'eval_steps_per_second': 14.81, 'epoch': 19.0}
{'loss': 5.8279, 'grad_norm': 2.12624192237854, 'learning_rate': 3.980354475229178e-11, 'epoch': 20.0}
{'eval_loss': 6.150001525878906, 'eval_accuracy': 0.1389094497902788, 'eval_runtime': 1.0152, 'eval_samples_per_second': 115.246, 'eval_steps_per_second': 14.775, 'epoch': 20.0}
{'train_runtime': 193.8444, 'train_samples_per_second': 48.183, 'train_steps_per_second': 6.087, 'train_loss': 6.617363286422471, 'epoch': 20.0}
test perplexity: 320.34382578984173
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  162914
{'loss': 6.0522, 'grad_norm': 4.998903274536133, 'learning_rate': 0.0006577025433315475, 'epoch': 1.0}
{'eval_loss': 3.4052300453186035, 'eval_accuracy': 0.13023255813953488, 'eval_runtime': 1.1011, 'eval_samples_per_second': 106.258, 'eval_steps_per_second': 13.623, 'epoch': 1.0}
{'loss': 2.1807, 'grad_norm': 2.2968151569366455, 'learning_rate': 0.0013267447856860528, 'epoch': 2.0}
{'eval_loss': 1.7897486686706543, 'eval_accuracy': 0.47930126824599184, 'eval_runtime': 1.0214, 'eval_samples_per_second': 114.552, 'eval_steps_per_second': 14.686, 'epoch': 2.0}
{'loss': 1.7876, 'grad_norm': 1.9886071681976318, 'learning_rate': 0.001995787028040558, 'epoch': 3.0}
{'eval_loss': 1.5069791078567505, 'eval_accuracy': 0.5581505071950932, 'eval_runtime': 1.0299, 'eval_samples_per_second': 113.6, 'eval_steps_per_second': 14.564, 'epoch': 3.0}
{'loss': 1.5337, 'grad_norm': 1.823622465133667, 'learning_rate': 0.002664829270395063, 'epoch': 4.0}
{'eval_loss': 1.38057541847229, 'eval_accuracy': 0.6074195820615168, 'eval_runtime': 1.0214, 'eval_samples_per_second': 114.55, 'eval_steps_per_second': 14.686, 'epoch': 4.0}
{'loss': 1.3726, 'grad_norm': 1.9867051839828491, 'learning_rate': 0.003333871512749568, 'epoch': 5.0}
{'eval_loss': 1.2710108757019043, 'eval_accuracy': 0.6262577862961188, 'eval_runtime': 1.0262, 'eval_samples_per_second': 114.011, 'eval_steps_per_second': 14.617, 'epoch': 5.0}
{'loss': 1.2605, 'grad_norm': 1.9068372249603271, 'learning_rate': 0.004002913755104073, 'epoch': 6.0}
{'eval_loss': 1.1171290874481201, 'eval_accuracy': 0.6830866294588692, 'eval_runtime': 1.0154, 'eval_samples_per_second': 115.22, 'eval_steps_per_second': 14.772, 'epoch': 6.0}
{'loss': 1.1872, 'grad_norm': 1.7319759130477905, 'learning_rate': 0.004671955997458579, 'epoch': 7.0}
{'eval_loss': 1.0849062204360962, 'eval_accuracy': 0.7057963955187531, 'eval_runtime': 1.0384, 'eval_samples_per_second': 112.677, 'eval_steps_per_second': 14.446, 'epoch': 7.0}
{'loss': 1.1173, 'grad_norm': 1.5179835557937622, 'learning_rate': 0.005340998239813084, 'epoch': 8.0}
{'eval_loss': 1.0502914190292358, 'eval_accuracy': 0.6957364341085271, 'eval_runtime': 1.0203, 'eval_samples_per_second': 114.668, 'eval_steps_per_second': 14.701, 'epoch': 8.0}
{'loss': 1.0785, 'grad_norm': 1.2056971788406372, 'learning_rate': 0.005642663804570102, 'epoch': 9.0}
{'eval_loss': 1.007051944732666, 'eval_accuracy': 0.7114077669902913, 'eval_runtime': 1.0199, 'eval_samples_per_second': 114.717, 'eval_steps_per_second': 14.707, 'epoch': 9.0}
{'loss': 1.0225, 'grad_norm': 1.4544318914413452, 'learning_rate': 0.005433559127651608, 'epoch': 10.0}
{'eval_loss': 0.9812016487121582, 'eval_accuracy': 0.7220386974988202, 'eval_runtime': 1.0325, 'eval_samples_per_second': 113.32, 'eval_steps_per_second': 14.528, 'epoch': 10.0}
{'loss': 0.9907, 'grad_norm': 2.0152032375335693, 'learning_rate': 0.0050325696983645075, 'epoch': 11.0}
{'eval_loss': 0.9641936421394348, 'eval_accuracy': 0.7294662442115525, 'eval_runtime': 1.0493, 'eval_samples_per_second': 111.499, 'eval_steps_per_second': 14.295, 'epoch': 11.0}
{'loss': 0.9494, 'grad_norm': 1.6351958513259888, 'learning_rate': 0.004469304821570172, 'epoch': 12.0}
{'eval_loss': 0.9469471573829651, 'eval_accuracy': 0.7353780313837375, 'eval_runtime': 1.0494, 'eval_samples_per_second': 111.493, 'eval_steps_per_second': 14.294, 'epoch': 12.0}
{'loss': 0.9143, 'grad_norm': 1.1209405660629272, 'learning_rate': 0.003785356320485379, 'epoch': 13.0}
{'eval_loss': 0.8681880235671997, 'eval_accuracy': 0.7603936039360394, 'eval_runtime': 1.0327, 'eval_samples_per_second': 113.301, 'eval_steps_per_second': 14.526, 'epoch': 13.0}
{'loss': 0.8405, 'grad_norm': 0.9583197236061096, 'learning_rate': 0.003031227371002073, 'epoch': 14.0}
{'eval_loss': 0.8503174781799316, 'eval_accuracy': 0.7673723536737236, 'eval_runtime': 1.0625, 'eval_samples_per_second': 110.114, 'eval_steps_per_second': 14.117, 'epoch': 14.0}
{'loss': 0.8153, 'grad_norm': 1.0864126682281494, 'learning_rate': 0.0022626033162719047, 'epoch': 15.0}
{'eval_loss': 0.8331828117370605, 'eval_accuracy': 0.7707790670139711, 'eval_runtime': 1.0229, 'eval_samples_per_second': 114.377, 'eval_steps_per_second': 14.664, 'epoch': 15.0}
{'loss': 0.7677, 'grad_norm': 1.261691689491272, 'learning_rate': 0.0015362398268888567, 'epoch': 16.0}
{'eval_loss': 0.7839725017547607, 'eval_accuracy': 0.7853025936599424, 'eval_runtime': 1.0201, 'eval_samples_per_second': 114.69, 'eval_steps_per_second': 14.704, 'epoch': 16.0}
{'loss': 0.749, 'grad_norm': 1.378556728363037, 'learning_rate': 0.0009057720274385042, 'epoch': 17.0}
{'eval_loss': 0.8020024299621582, 'eval_accuracy': 0.7843089030988687, 'eval_runtime': 1.0175, 'eval_samples_per_second': 114.984, 'eval_steps_per_second': 14.742, 'epoch': 17.0}
{'loss': 0.7252, 'grad_norm': 0.926135778427124, 'learning_rate': 0.00041775404607427764, 'epoch': 18.0}
{'eval_loss': 0.7582138776779175, 'eval_accuracy': 0.78771887742864, 'eval_runtime': 1.0306, 'eval_samples_per_second': 113.521, 'eval_steps_per_second': 14.554, 'epoch': 18.0}
{'loss': 0.7204, 'grad_norm': 1.3106541633605957, 'learning_rate': 0.00010822142920380576, 'epoch': 19.0}
{'eval_loss': 0.7429412007331848, 'eval_accuracy': 0.7911220715166462, 'eval_runtime': 1.0232, 'eval_samples_per_second': 114.346, 'eval_steps_per_second': 14.66, 'epoch': 19.0}
{'loss': 0.7091, 'grad_norm': 1.2898410558700562, 'learning_rate': 3.025468866686256e-08, 'epoch': 20.0}
{'eval_loss': 0.7684119939804077, 'eval_accuracy': 0.7875647668393783, 'eval_runtime': 1.0503, 'eval_samples_per_second': 111.395, 'eval_steps_per_second': 14.281, 'epoch': 20.0}
{'train_runtime': 194.9533, 'train_samples_per_second': 47.909, 'train_steps_per_second': 6.053, 'train_loss': 1.3387127536838337, 'epoch': 20.0}
test perplexity: 2.1773689396329825
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  162914
{'loss': 7.3446, 'grad_norm': 2.71066951751709, 'learning_rate': 5.301853195769689e-05, 'epoch': 1.0}
{'eval_loss': 7.681000709533691, 'eval_accuracy': 0.13708690330477355, 'eval_runtime': 1.0884, 'eval_samples_per_second': 107.493, 'eval_steps_per_second': 13.781, 'epoch': 1.0}
{'loss': 6.4218, 'grad_norm': 3.704923152923584, 'learning_rate': 0.00010695117653535408, 'epoch': 2.0}
{'eval_loss': 5.625524997711182, 'eval_accuracy': 0.135678391959799, 'eval_runtime': 1.0275, 'eval_samples_per_second': 113.87, 'eval_steps_per_second': 14.599, 'epoch': 2.0}
{'loss': 4.1785, 'grad_norm': 2.512253522872925, 'learning_rate': 0.00016088382111301125, 'epoch': 3.0}
{'eval_loss': 3.400449752807617, 'eval_accuracy': 0.12384996461429583, 'eval_runtime': 1.0328, 'eval_samples_per_second': 113.289, 'eval_steps_per_second': 14.524, 'epoch': 3.0}
{'loss': 2.645, 'grad_norm': 2.7711925506591797, 'learning_rate': 0.00021481646569066843, 'epoch': 4.0}
{'eval_loss': 2.01766300201416, 'eval_accuracy': 0.435313453862409, 'eval_runtime': 1.0199, 'eval_samples_per_second': 114.713, 'eval_steps_per_second': 14.707, 'epoch': 4.0}
{'loss': 2.0547, 'grad_norm': 1.8653557300567627, 'learning_rate': 0.0002687491102683256, 'epoch': 5.0}
{'eval_loss': 1.9004815816879272, 'eval_accuracy': 0.4463344513655966, 'eval_runtime': 1.0235, 'eval_samples_per_second': 114.309, 'eval_steps_per_second': 14.655, 'epoch': 5.0}
{'loss': 1.9587, 'grad_norm': 2.871671676635742, 'learning_rate': 0.00032268175484598277, 'epoch': 6.0}
{'eval_loss': 1.7461367845535278, 'eval_accuracy': 0.48920165008493083, 'eval_runtime': 1.0359, 'eval_samples_per_second': 112.94, 'eval_steps_per_second': 14.479, 'epoch': 6.0}
{'loss': 1.8866, 'grad_norm': 3.463425397872925, 'learning_rate': 0.00037661439942364, 'epoch': 7.0}
{'eval_loss': 1.6890034675598145, 'eval_accuracy': 0.5107160253287871, 'eval_runtime': 1.0195, 'eval_samples_per_second': 114.757, 'eval_steps_per_second': 14.712, 'epoch': 7.0}
{'loss': 1.792, 'grad_norm': 2.515669822692871, 'learning_rate': 0.00043054704400129716, 'epoch': 8.0}
{'eval_loss': 1.5955755710601807, 'eval_accuracy': 0.5356104651162791, 'eval_runtime': 1.038, 'eval_samples_per_second': 112.719, 'eval_steps_per_second': 14.451, 'epoch': 8.0}
{'loss': 1.6958, 'grad_norm': 3.4965147972106934, 'learning_rate': 0.00045486482344090647, 'epoch': 9.0}
{'eval_loss': 1.5173728466033936, 'eval_accuracy': 0.5650485436893203, 'eval_runtime': 1.9063, 'eval_samples_per_second': 61.375, 'eval_steps_per_second': 7.869, 'epoch': 9.0}
{'loss': 1.6032, 'grad_norm': 2.8307509422302246, 'learning_rate': 0.0004380085361905189, 'epoch': 10.0}
{'eval_loss': 1.4571727514266968, 'eval_accuracy': 0.5797546012269938, 'eval_runtime': 1.917, 'eval_samples_per_second': 61.032, 'eval_steps_per_second': 7.825, 'epoch': 10.0}
{'loss': 1.5518, 'grad_norm': 5.2919020652771, 'learning_rate': 0.0004056840893917178, 'epoch': 11.0}
{'eval_loss': 1.411604881286621, 'eval_accuracy': 0.5849378503534, 'eval_runtime': 1.9077, 'eval_samples_per_second': 61.332, 'eval_steps_per_second': 7.863, 'epoch': 11.0}
{'loss': 1.4801, 'grad_norm': 4.206121921539307, 'learning_rate': 0.00036027833997846894, 'epoch': 12.0}
{'eval_loss': 1.4052129983901978, 'eval_accuracy': 0.6010461245839277, 'eval_runtime': 1.4436, 'eval_samples_per_second': 81.045, 'eval_steps_per_second': 10.39, 'epoch': 12.0}
{'loss': 1.4461, 'grad_norm': 3.6575798988342285, 'learning_rate': 0.0003051440762754573, 'epoch': 13.0}
{'eval_loss': 1.3274630308151245, 'eval_accuracy': 0.6204182041820419, 'eval_runtime': 1.8993, 'eval_samples_per_second': 61.602, 'eval_steps_per_second': 7.898, 'epoch': 13.0}
{'loss': 1.3716, 'grad_norm': 4.0233588218688965, 'learning_rate': 0.0002443524460563086, 'epoch': 14.0}
{'eval_loss': 1.2822288274765015, 'eval_accuracy': 0.6341220423412204, 'eval_runtime': 1.8861, 'eval_samples_per_second': 62.034, 'eval_steps_per_second': 7.953, 'epoch': 14.0}
{'loss': 1.3496, 'grad_norm': 4.057653903961182, 'learning_rate': 0.00018239234050047032, 'epoch': 15.0}
{'eval_loss': 1.249588131904602, 'eval_accuracy': 0.6419606914515747, 'eval_runtime': 1.8747, 'eval_samples_per_second': 62.41, 'eval_steps_per_second': 8.001, 'epoch': 15.0}
{'loss': 1.3296, 'grad_norm': 4.782586574554443, 'learning_rate': 0.00012383893172134976, 'epoch': 16.0}
{'eval_loss': 1.217164397239685, 'eval_accuracy': 0.6462536023054755, 'eval_runtime': 1.8852, 'eval_samples_per_second': 62.063, 'eval_steps_per_second': 7.957, 'epoch': 16.0}
{'loss': 1.3249, 'grad_norm': 4.365355968475342, 'learning_rate': 7.301583925748637e-05, 'epoch': 17.0}
{'eval_loss': 1.249995231628418, 'eval_accuracy': 0.6392031480570586, 'eval_runtime': 1.9538, 'eval_samples_per_second': 59.883, 'eval_steps_per_second': 7.677, 'epoch': 17.0}
{'loss': 1.2854, 'grad_norm': 5.781063556671143, 'learning_rate': 3.367587135979968e-05, 'epoch': 18.0}
{'eval_loss': 1.2261145114898682, 'eval_accuracy': 0.6402014871671864, 'eval_runtime': 1.9319, 'eval_samples_per_second': 60.563, 'eval_steps_per_second': 7.764, 'epoch': 18.0}
{'loss': 1.3009, 'grad_norm': 4.9547834396362305, 'learning_rate': 8.723915333648354e-06, 'epoch': 19.0}
{'eval_loss': 1.1984479427337646, 'eval_accuracy': 0.6651048088779284, 'eval_runtime': 1.8875, 'eval_samples_per_second': 61.986, 'eval_steps_per_second': 7.947, 'epoch': 19.0}
{'loss': 1.2961, 'grad_norm': 4.961309909820557, 'learning_rate': 2.4388824313024096e-09, 'epoch': 20.0}
{'eval_loss': 1.2237275838851929, 'eval_accuracy': 0.6484085862324205, 'eval_runtime': 1.7716, 'eval_samples_per_second': 66.041, 'eval_steps_per_second': 8.467, 'epoch': 20.0}
{'train_runtime': 274.1899, 'train_samples_per_second': 34.064, 'train_steps_per_second': 4.304, 'train_loss': 2.2658465627896582, 'epoch': 20.0}
test perplexity: 3.7230518586591423
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512474
lora model :  162914
{'loss': 6.0522, 'grad_norm': 4.998903751373291, 'learning_rate': 0.0006577025433315475, 'epoch': 1.0}
{'eval_loss': 3.4052300453186035, 'eval_accuracy': 0.13023255813953488, 'eval_runtime': 2.0047, 'eval_samples_per_second': 58.364, 'eval_steps_per_second': 7.483, 'epoch': 1.0}
{'loss': 2.1807, 'grad_norm': 2.2968146800994873, 'learning_rate': 0.0013267447856860528, 'epoch': 2.0}
{'eval_loss': 1.7897486686706543, 'eval_accuracy': 0.47930126824599184, 'eval_runtime': 1.8506, 'eval_samples_per_second': 63.223, 'eval_steps_per_second': 8.105, 'epoch': 2.0}
{'loss': 1.7876, 'grad_norm': 1.9886070489883423, 'learning_rate': 0.001995787028040558, 'epoch': 3.0}
{'eval_loss': 1.5069791078567505, 'eval_accuracy': 0.5581505071950932, 'eval_runtime': 1.8766, 'eval_samples_per_second': 62.346, 'eval_steps_per_second': 7.993, 'epoch': 3.0}
{'loss': 1.5337, 'grad_norm': 1.8236254453659058, 'learning_rate': 0.002664829270395063, 'epoch': 4.0}
{'eval_loss': 1.38057541847229, 'eval_accuracy': 0.6074195820615168, 'eval_runtime': 1.8514, 'eval_samples_per_second': 63.197, 'eval_steps_per_second': 8.102, 'epoch': 4.0}
{'loss': 1.3726, 'grad_norm': 1.9867050647735596, 'learning_rate': 0.003333871512749568, 'epoch': 5.0}
{'eval_loss': 1.2710108757019043, 'eval_accuracy': 0.6262577862961188, 'eval_runtime': 1.8538, 'eval_samples_per_second': 63.112, 'eval_steps_per_second': 8.091, 'epoch': 5.0}
{'loss': 1.2605, 'grad_norm': 1.9068301916122437, 'learning_rate': 0.004002913755104073, 'epoch': 6.0}
{'eval_loss': 1.1171292066574097, 'eval_accuracy': 0.6830866294588692, 'eval_runtime': 1.8788, 'eval_samples_per_second': 62.273, 'eval_steps_per_second': 7.984, 'epoch': 6.0}
{'loss': 1.1872, 'grad_norm': 1.7319926023483276, 'learning_rate': 0.004671955997458579, 'epoch': 7.0}
{'eval_loss': 1.0849058628082275, 'eval_accuracy': 0.7057963955187531, 'eval_runtime': 1.8759, 'eval_samples_per_second': 62.37, 'eval_steps_per_second': 7.996, 'epoch': 7.0}
{'loss': 1.1173, 'grad_norm': 1.5179873704910278, 'learning_rate': 0.005340998239813084, 'epoch': 8.0}
{'eval_loss': 1.0502912998199463, 'eval_accuracy': 0.6957364341085271, 'eval_runtime': 1.9114, 'eval_samples_per_second': 61.213, 'eval_steps_per_second': 7.848, 'epoch': 8.0}
{'loss': 1.0785, 'grad_norm': 1.205665111541748, 'learning_rate': 0.005642663804570102, 'epoch': 9.0}
{'eval_loss': 1.0070490837097168, 'eval_accuracy': 0.7114077669902913, 'eval_runtime': 1.911, 'eval_samples_per_second': 61.223, 'eval_steps_per_second': 7.849, 'epoch': 9.0}
{'loss': 1.0225, 'grad_norm': 1.4545611143112183, 'learning_rate': 0.005433559127651608, 'epoch': 10.0}
{'eval_loss': 0.9812095761299133, 'eval_accuracy': 0.7220386974988202, 'eval_runtime': 1.9134, 'eval_samples_per_second': 61.147, 'eval_steps_per_second': 7.839, 'epoch': 10.0}
{'loss': 0.9907, 'grad_norm': 2.0150787830352783, 'learning_rate': 0.0050325696983645075, 'epoch': 11.0}
{'eval_loss': 0.9642160534858704, 'eval_accuracy': 0.7292225201072386, 'eval_runtime': 1.8811, 'eval_samples_per_second': 62.197, 'eval_steps_per_second': 7.974, 'epoch': 11.0}
{'loss': 0.9494, 'grad_norm': 1.6351579427719116, 'learning_rate': 0.004469304821570172, 'epoch': 12.0}
{'eval_loss': 0.9469113349914551, 'eval_accuracy': 0.7351402757964812, 'eval_runtime': 1.8386, 'eval_samples_per_second': 63.635, 'eval_steps_per_second': 8.158, 'epoch': 12.0}
{'loss': 0.9143, 'grad_norm': 1.1210283041000366, 'learning_rate': 0.003785356320485379, 'epoch': 13.0}
{'eval_loss': 0.8681784272193909, 'eval_accuracy': 0.7603936039360394, 'eval_runtime': 1.8476, 'eval_samples_per_second': 63.324, 'eval_steps_per_second': 8.118, 'epoch': 13.0}
{'loss': 0.8405, 'grad_norm': 0.9585821032524109, 'learning_rate': 0.003031227371002073, 'epoch': 14.0}
{'eval_loss': 0.8503004908561707, 'eval_accuracy': 0.7673723536737236, 'eval_runtime': 1.8612, 'eval_samples_per_second': 62.862, 'eval_steps_per_second': 8.059, 'epoch': 14.0}
{'loss': 0.8153, 'grad_norm': 1.086429476737976, 'learning_rate': 0.0022626033162719047, 'epoch': 15.0}
{'eval_loss': 0.8331511616706848, 'eval_accuracy': 0.7707790670139711, 'eval_runtime': 1.877, 'eval_samples_per_second': 62.333, 'eval_steps_per_second': 7.991, 'epoch': 15.0}
{'loss': 0.7677, 'grad_norm': 1.2617838382720947, 'learning_rate': 0.0015362398268888567, 'epoch': 16.0}
{'eval_loss': 0.7839864492416382, 'eval_accuracy': 0.7855427473583093, 'eval_runtime': 1.87, 'eval_samples_per_second': 62.567, 'eval_steps_per_second': 8.021, 'epoch': 16.0}
{'loss': 0.749, 'grad_norm': 1.378673791885376, 'learning_rate': 0.0009057720274385042, 'epoch': 17.0}
{'eval_loss': 0.8019871711730957, 'eval_accuracy': 0.7843089030988687, 'eval_runtime': 1.8648, 'eval_samples_per_second': 62.74, 'eval_steps_per_second': 8.044, 'epoch': 17.0}
{'loss': 0.7252, 'grad_norm': 0.9259787201881409, 'learning_rate': 0.00041775404607427764, 'epoch': 18.0}
{'eval_loss': 0.7582187652587891, 'eval_accuracy': 0.78771887742864, 'eval_runtime': 1.835, 'eval_samples_per_second': 63.76, 'eval_steps_per_second': 8.174, 'epoch': 18.0}
{'loss': 0.7203, 'grad_norm': 1.3105919361114502, 'learning_rate': 0.00010822142920380576, 'epoch': 19.0}
{'eval_loss': 0.742924153804779, 'eval_accuracy': 0.7911220715166462, 'eval_runtime': 1.7578, 'eval_samples_per_second': 66.561, 'eval_steps_per_second': 8.533, 'epoch': 19.0}
{'loss': 0.7091, 'grad_norm': 1.28989577293396, 'learning_rate': 3.025468866686256e-08, 'epoch': 20.0}
{'eval_loss': 0.7683990597724915, 'eval_accuracy': 0.7878114976560573, 'eval_runtime': 1.8874, 'eval_samples_per_second': 61.989, 'eval_steps_per_second': 7.947, 'epoch': 20.0}
{'train_runtime': 331.2099, 'train_samples_per_second': 28.2, 'train_steps_per_second': 3.563, 'train_loss': 1.3387108269384351, 'epoch': 20.0}
test perplexity: 2.1773823071481413
(LoRA) Trial 0 - value: 0.15269631031220435; params: {'lora_r': 2, 'lora_alpha': 32, 'lora_weights': 'q'}
(LoRA) Trial 1 - value: 0.13528855250709557; params: {'lora_r': 1, 'lora_alpha': 100, 'lora_weights': 'kv'}
(LoRA) Trial 2 - value: 0.1534531693472091; params: {'lora_r': 1, 'lora_alpha': 1, 'lora_weights': 'ko'}
(HPs)  Trial 0 - value: 0.15193945127719963; params: {'lr': 7.45934328572655e-06}
(HPs)  Trial 1 - value: 0.7797540208136234; params: {'lr': 0.005669849511478858}
(HPs)  Trial 2 - value: 0.6295175023651844; params: {'lr': 0.0004570563099801456}
Optimization Step 1 - LoRA HPs; Best Optuna trial: 0.1534531693472091; Best LoRA params: {'lora_r': 1, 'lora_alpha': 1, 'lora_weights': 'ko'}
Optimization Step 2 - Training HPs; Best Optuna trial: 0.7797540208136234; Best HPs: 0.7797540208136234; Default LR: 1e-05
test score: 0.7797540208136234
Time taken:  1782.5611279010773 sec.
