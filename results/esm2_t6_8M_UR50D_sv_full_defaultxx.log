CUDA available: False
Number of GPUs: 0
Namespace(objective='sv', default=True, optim=False, inp_path='data/fluorescence.csv', out_path='results/esm2_t6_8M_UR50D_sv_full_default', seqcol='sequence', ycol='label', truncate=1.0, checkpoint='facebook/esm2_t6_8M_UR50D', full=True, lora_r=4, lora_alpha=1, lora_weights='qkvo', lora_dropout=0.0, epochs=20, lr=1e-05, batch=8, accum=1, val_batch=8, seed=42, num_labels=1, earlystop=False, n_trials1=3, n_trials2=3)
PERFORM FULL MODEL FINETUNING...
device: cpu
{'train': Dataset({
    features: ['sequence', 'label', '__index_level_0__', 'input_ids', 'attention_mask'],
    num_rows: 2097
}), 'valid': Dataset({
    features: ['sequence', 'label', '__index_level_0__', 'input_ids', 'attention_mask'],
    num_rows: 524
}), 'test': Dataset({
    features: ['sequence', 'label', '__index_level_0__', 'input_ids', 'attention_mask'],
    num_rows: 2552
})}
Model used: facebook/esm2_t6_8M_UR50D 

Early stopping NOT implemented.
full model :  7512122
{'loss': 8.2808, 'grad_norm': 34.033935546875, 'learning_rate': 5.240000000000001e-06, 'epoch': 1.0}
{'eval_loss': 4.222642421722412, 'eval_spearmanr': 0.31501084250901384, 'eval_runtime': 5.5627, 'eval_samples_per_second': 94.198, 'eval_steps_per_second': 11.865, 'epoch': 1.0}
{'loss': 2.2571, 'grad_norm': 11.436847686767578, 'learning_rate': 9.999319393624579e-06, 'epoch': 2.0}
{'eval_loss': 0.9215936064720154, 'eval_spearmanr': 0.22673374045675534, 'eval_runtime': 5.2926, 'eval_samples_per_second': 99.007, 'eval_steps_per_second': 12.47, 'epoch': 2.0}
{'loss': 0.6732, 'grad_norm': 276.14764404296875, 'learning_rate': 9.909946036218694e-06, 'epoch': 3.0}
{'eval_loss': 0.767064094543457, 'eval_spearmanr': 0.26762738040581074, 'eval_runtime': 5.6337, 'eval_samples_per_second': 93.012, 'eval_steps_per_second': 11.715, 'epoch': 3.0}
{'loss': 0.5694, 'grad_norm': 16.775671005249023, 'learning_rate': 9.673007684510775e-06, 'epoch': 4.0}
{'eval_loss': 0.4967859983444214, 'eval_spearmanr': 0.31740947832504757, 'eval_runtime': 5.5208, 'eval_samples_per_second': 94.914, 'eval_steps_per_second': 11.955, 'epoch': 4.0}
{'loss': 0.5307, 'grad_norm': 106.7585220336914, 'learning_rate': 9.295625354956361e-06, 'epoch': 5.0}
{'eval_loss': 0.5768082141876221, 'eval_spearmanr': 0.38663454668451275, 'eval_runtime': 5.5042, 'eval_samples_per_second': 95.2, 'eval_steps_per_second': 11.991, 'epoch': 5.0}
{'loss': 0.4759, 'grad_norm': 4.193334579467773, 'learning_rate': 8.78914100954436e-06, 'epoch': 6.0}
{'eval_loss': 0.4425894320011139, 'eval_spearmanr': 0.46036306151105194, 'eval_runtime': 5.2378, 'eval_samples_per_second': 100.042, 'eval_steps_per_second': 12.601, 'epoch': 6.0}
{'loss': 0.4597, 'grad_norm': 24.627771377563477, 'learning_rate': 8.168776681061583e-06, 'epoch': 7.0}
{'eval_loss': 0.404536634683609, 'eval_spearmanr': 0.4641246873631017, 'eval_runtime': 5.4917, 'eval_samples_per_second': 95.416, 'eval_steps_per_second': 12.018, 'epoch': 7.0}
{'loss': 0.4308, 'grad_norm': 102.62299346923828, 'learning_rate': 7.453176985543002e-06, 'epoch': 8.0}
{'eval_loss': 0.456217885017395, 'eval_spearmanr': 0.4702119059160129, 'eval_runtime': 5.2591, 'eval_samples_per_second': 99.637, 'eval_steps_per_second': 12.55, 'epoch': 8.0}
{'loss': 0.3668, 'grad_norm': 10.373222351074219, 'learning_rate': 6.663848771376116e-06, 'epoch': 9.0}
{'eval_loss': 0.32869860529899597, 'eval_spearmanr': 0.5454081155771099, 'eval_runtime': 5.5447, 'eval_samples_per_second': 94.504, 'eval_steps_per_second': 11.903, 'epoch': 9.0}
{'loss': 0.3648, 'grad_norm': 6.279390335083008, 'learning_rate': 5.824514746013667e-06, 'epoch': 10.0}
{'eval_loss': 0.26820218563079834, 'eval_spearmanr': 0.5811022836307684, 'eval_runtime': 5.3855, 'eval_samples_per_second': 97.298, 'eval_steps_per_second': 12.255, 'epoch': 10.0}
{'loss': 0.3203, 'grad_norm': 26.703840255737305, 'learning_rate': 4.960400506591848e-06, 'epoch': 11.0}
{'eval_loss': 0.22388702630996704, 'eval_spearmanr': 0.5984555075676887, 'eval_runtime': 5.4151, 'eval_samples_per_second': 96.766, 'eval_steps_per_second': 12.188, 'epoch': 11.0}
{'loss': 0.2899, 'grad_norm': 4.438296794891357, 'learning_rate': 4.0974764022501355e-06, 'epoch': 12.0}
{'eval_loss': 0.22543255984783173, 'eval_spearmanr': 0.6049300477508338, 'eval_runtime': 5.2374, 'eval_samples_per_second': 100.049, 'eval_steps_per_second': 12.602, 'epoch': 12.0}
{'loss': 0.2463, 'grad_norm': 136.5164031982422, 'learning_rate': 3.261677013450506e-06, 'epoch': 13.0}
{'eval_loss': 0.1894337385892868, 'eval_spearmanr': 0.6351801824131342, 'eval_runtime': 5.4795, 'eval_samples_per_second': 95.63, 'eval_steps_per_second': 12.045, 'epoch': 13.0}
{'loss': 0.2286, 'grad_norm': 474.58917236328125, 'learning_rate': 2.4781217062992417e-06, 'epoch': 14.0}
{'eval_loss': 0.18321935832500458, 'eval_spearmanr': 0.639770693789701, 'eval_runtime': 5.3005, 'eval_samples_per_second': 98.859, 'eval_steps_per_second': 12.452, 'epoch': 14.0}
{'loss': 0.2066, 'grad_norm': 11.99844741821289, 'learning_rate': 1.7703596875660645e-06, 'epoch': 15.0}
{'eval_loss': 0.21992547810077667, 'eval_spearmanr': 0.640113875781902, 'eval_runtime': 5.5362, 'eval_samples_per_second': 94.649, 'eval_steps_per_second': 11.921, 'epoch': 15.0}
{'loss': 0.1731, 'grad_norm': 24.17108154296875, 'learning_rate': 1.1596622497440357e-06, 'epoch': 16.0}
{'eval_loss': 0.17912299931049347, 'eval_spearmanr': 0.6523566717871638, 'eval_runtime': 5.3557, 'eval_samples_per_second': 97.84, 'eval_steps_per_second': 12.323, 'epoch': 16.0}
{'loss': 0.1663, 'grad_norm': 6.000787258148193, 'learning_rate': 6.643834772299551e-07, 'epoch': 17.0}
{'eval_loss': 0.19212321937084198, 'eval_spearmanr': 0.6401015185389725, 'eval_runtime': 5.6848, 'eval_samples_per_second': 92.176, 'eval_steps_per_second': 11.61, 'epoch': 17.0}
{'loss': 0.1577, 'grad_norm': 33.485294342041016, 'learning_rate': 2.9940862715390483e-07, 'epoch': 18.0}
{'eval_loss': 0.1715339869260788, 'eval_spearmanr': 0.6537776793922849, 'eval_runtime': 5.3535, 'eval_samples_per_second': 97.879, 'eval_steps_per_second': 12.328, 'epoch': 18.0}
{'loss': 0.1522, 'grad_norm': 0.7154885530471802, 'learning_rate': 7.570676338635896e-08, 'epoch': 19.0}
{'eval_loss': 0.16986703872680664, 'eval_spearmanr': 0.6571863878481905, 'eval_runtime': 5.5851, 'eval_samples_per_second': 93.82, 'eval_steps_per_second': 11.817, 'epoch': 19.0}
{'loss': 0.1473, 'grad_norm': 0.05475011467933655, 'learning_rate': 1.0889948676151562e-12, 'epoch': 20.0}
{'eval_loss': 0.16980868577957153, 'eval_spearmanr': 0.6574409807001133, 'eval_runtime': 5.3262, 'eval_samples_per_second': 98.381, 'eval_steps_per_second': 12.391, 'epoch': 20.0}
{'train_runtime': 780.4672, 'train_samples_per_second': 53.737, 'train_steps_per_second': 6.74, 'train_loss': 0.824872727629803, 'epoch': 20.0}
test score: 0.6453099467520488
Time taken:  807.1288189888 sec.
